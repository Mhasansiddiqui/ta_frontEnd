<div class="converter-container">
  <mat-card>
    <mat-card-content>
      <form [formGroup]="converterForm" (ngSubmit)="onSubmit()">
        <!-- Amount Input -->
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Amount</mat-label>
          <input matInput type="number" formControlName="amount" required>
        </mat-form-field>

        <!-- From Currency -->
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>From Currency</mat-label>
          <mat-select formControlName="fromCurrency" required>
            @for (currency of currencies | keyvalue; track currency.key) {
              <mat-option [value]="currency.key">
                {{ currency.value.name }} ({{ currency.key }})
              </mat-option>
            }
          </mat-select>
        </mat-form-field>

        <!-- To Currency -->
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>To Currency</mat-label>
          <mat-select formControlName="toCurrency" required>
            @for (currency of currencies | keyvalue; track currency.key) {
              <mat-option [value]="currency.key">
                {{ currency.value.name }} ({{ currency.key }})
              </mat-option>
            }
          </mat-select>
        </mat-form-field>

        <!-- Submit Button -->
        <button mat-raised-button color="primary" type="submit" class="full-width"
                [disabled]="!converterForm.valid || loading">
          @if (loading) {
            <mat-spinner diameter="20"></mat-spinner>
            Converting...
          } @else {
            Convert
          }
        </button>
      </form>

      @if (result) {
        <div class="result-container">
          <h2>Result</h2>
          <p class="result">
            {{ converterForm.get('amount')?.value }} {{ converterForm.get('fromCurrency')?.value }} =
            {{ result }} {{ converterForm.get('toCurrency')?.value }}
          </p>
        </div>
      }
    </mat-card-content>
  </mat-card>

  <!-- Conversion History -->
  <mat-card class="history-card">
    <mat-card-header>
      <mat-card-title>Conversion History</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-list>
        @for (conversion of conversionHistory; track conversion.id) {
          <mat-list-item>
            <div class="history-item">
              <span>{{ conversion.amount }} {{ conversion.fromCurrency }} to {{ conversion.toCurrency }}</span>
              <span>= {{ conversion.result }}</span>
              <span class="history-date">{{ conversion.date | date:'short' }}</span>
            </div>
          </mat-list-item>
          <mat-divider></mat-divider>
        }
      </mat-list>
    </mat-card-content>
  </mat-card>
</div>